if an subitem is shared instead of an item the invite will be sent so the shared user will have its invitation, if he rejects it a message should be sent for the inviter and when he accepts it the invitation should be deleted these happens now based on my current codes and dont need to change
the thing that need to be changed is that the subitem that has been shared should be appeared in the homepage as an item (not its parents) and it has to contain its subitems until the last layer like other sharing senarios 
but now the invitation comes and when user accepts it, the invitation is gone but the item doesnt appear in his homepage!

give me the whole homepage code first (all of it together)
then becuase the itemdetail code is lone give me the code on 2 parts in two messages. give me the code until before <script> after this message. the i will ask you to give me the rest of the code

i want you to just change the things that i said and dont touch anything else. because every thing is perfect
explain in farsi

check if its ok or not:
current homepage code: